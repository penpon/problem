# 🚀 JavaScript自動採点システム

プログラミング学習用に作られた、ブラウザで動作する自動採点システムです。

## ✨ 特徴

- **🌐 ブラウザだけで動作**: インストール不要、URLにアクセスするだけ
- **🔒 セキュア**: Web Workerによる安全な実行環境
- **📱 レスポンシブ**: PC・スマホ・タブレット対応
- **⚡ 高速**: リアルタイムでの採点結果表示
- **🧪 多角的テスト**: 複数テストケースによる包括的な採点
- **🚀 遅延読み込み**: 必要な問題のみを動的にロードし初期起動を高速化
- **💾 スケーラブル**: JSONファイル個別管理で数百問まで対応
- **🎨 美しいUI**: 直感的で使いやすいデザイン

## 🎯 対応問題

現在以下の練習問題に対応しています：

1. **practice21**: 電車の乗車券料金計算
2. **practice22**: 図書館延滞料金計算  
3. **practice23**: 成績統計計算
4. **practice24**: 映画館座席予約システム
5. **practice25**: 釣り銭計算プログラム

## 🚀 使い方

### 共有方法

1. **GitHub Pagesにデプロイ**
   ```bash
   # GitHubリポジトリを作成
   git init
   git add .
   git commit -m "Initial commit"
   git remote add origin https://github.com/[username]/js-auto-grader
   git push -u origin main
   
   # GitHub → Settings → Pages → Deploy from a branch → main
   ```

2. **URLを共有**
   ```
   https://[username].github.io/problem
   ```

3. **使用手順**
   - URLにアクセス
   - 問題を選択
   - コードを編集（穴埋め部分を完成）
   - 「🚀 コードを実行して採点」ボタンをクリック
   - 即座に採点結果を確認

### 学習者の使い方

1. **問題選択**: ドロップダウンから解きたい問題を選択
2. **コード編集**: 表示されたテンプレートの穴埋め部分を完成させる
3. **実行**: 実行ボタンまたは `Ctrl+Enter` で採点
4. **結果確認**: 
   - ✅ 全テストケース合格: 緑色で100点表示
   - ⚠️ 一部テストケース不合格: 黄色で部分点表示
   - ❌ 全テストケース不合格: 赤色で0点表示
   - 📊 詳細表示: 各テストケースの個別結果をクリックで展開

## 🔧 システム構成

```
github-pages-grader/
├── index.html              # メインページ
├── css/
│   └── style.css          # スタイルシート（複数テストケース対応UI含む）
├── js/
│   ├── main.js              # メインアプリケーション（非同期問題読み込み対応）
│   ├── problemLoader.js     # 問題遅延読み込みシステム（キャッシュ機能付き）
│   └── worker.js            # Web Worker（動的変数置換機能付き）
├── problems/                # 問題データ（JSON個別管理）
│   ├── index.json           # 問題一覧メタデータ
│   ├── practice21.json      # 個別問題ファイル
│   ├── practice22.json
│   └── ...
└── README.md              # このファイル
```

## 🛡️ セキュリティ機能

- **Web Worker分離**: ユーザーコードを安全な環境で実行
- **タイムアウト制御**: 5秒で自動停止（無限ループ対策）
- **スコープ分離**: グローバル変数の汚染防止
- **エラーハンドリング**: 実行エラーの安全な処理

## 📝 新しい問題の追加方法

### 🆕 新しいJSON形式（推奨）

1. **個別問題ファイル作成**
   ```json
   // problems/practice26.json
   {
     "id": "practice26",
     "title": "新しい問題のタイトル",
     "description": "問題の説明",
     "instructions": ["実装のポイント1", "実装のポイント2"],
     "template": "// コードテンプレート\\nlet example = \"Hello, World!\";\\nconsole.log(example);",
     "testCases": [
       {
         "name": "基本ケース",
         "variables": { "example": "Hello, World!" },
         "expectedOutput": "Hello, World!"
       },
       {
         "name": "別のケース", 
         "variables": { "example": "こんにちは" },
         "expectedOutput": "こんにちは"
       }
       // 最大5つまでのテストケースを追加可能
     ],
     "expectedOutput": "Hello, World!",
     "testVariables": { "example": "Hello, World!" },
     "points": 100
   }
   ```

2. **`problems/index.json`を更新**
   ```json
   {
     "version": "1.0.0",
     "problems": [
       // 既存の問題...
       {
         "id": "practice26",
         "title": "新しい問題のタイトル",
         "category": "基本",
         "difficulty": "初級",
         "points": 100
       }
     ]
   }
   ```

3. **GitHubにプッシュ**
   ```bash
   git add problems/practice26.json problems/index.json
   git commit -m "Add practice26"
   git push
   ```

4. **自動的に反映** - GitHub Pagesで即座に利用可能

## 🌟 高度な機能

### 遅延読み込みシステム
- **初期ロード最適化**: 問題一覧のみを最初に読み込み
- **選択時読み込み**: 問題選択時に詳細データを動的取得
- **インメモリキャッシュ**: 一度読み込んだ問題はキャッシュで高速アクセス
- **エラーハンドリング**: ネットワークエラー時の適切なユーザーフィードバック

### キーボードショートカット
- `Ctrl+Enter` (または `Cmd+Enter`): コード実行

### 採点機能
- **console.log出力の完全キャプチャ**
- **複数テストケース実行**: 基本・境界値・エラーケースなど5パターンで検証
- **動的変数置換**: テストケースごとに異なる変数値で自動実行
- **詳細な採点結果**: 個別テスト結果と進捗バーによる視覚的表示
- **文字単位での厳密な比較**
- **行ごとの詳細な差異表示**
- **実行時エラーの詳細表示**
- **展開式詳細表示**: クリックで各テストケースの詳細を確認可能

### レスポンシブデザイン
- デスクトップ: サイドバイサイドレイアウト
- モバイル: 縦積みレイアウト
- ダークモード対応

## 🔄 今後の拡張案

- [ ] コード実行履歴の保存
- [x] 複数テストケースの対応 ✨ **実装完了**
- [x] JSONファイル個別管理と遅延読み込み ✨ **実装完了**
- [ ] 実行時間とメモリ使用量の表示
- [ ] 問題の難易度表示
- [ ] 進捗管理機能

## 🐛 トラブルシューティング

### よくある問題

1. **「問題の読み込みに失敗しました」エラー**
   - ネットワーク接続を確認してください
   - ページを再読み込みしてみてください
   - サーバーが正常に動作しているか確認してください

2. **「Web Workerをサポートしていません」エラー**
   - 古いブラウザを使用している可能性があります
   - Chrome、Firefox、Safari、Edgeの最新版を使用してください

3. **実行ボタンが反応しない**
   - 問題が正常に選択・読み込みされているか確認してください
   - ブラウザのコンソールにエラーがないか確認してください

4. **コードが実行されない**
   - 構文エラーがないか確認してください
   - 5秒でタイムアウトするため、無限ループに注意してください

## 📄 ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 🤝 貢献

バグ報告や機能要望は、GitHubのIssuesでお知らせください。
プルリクエストも歓迎します！

---

**💡 ヒント**: 友達がより良い学習体験を得られるよう、定期的に新しい問題を追加することをお勧めします。
